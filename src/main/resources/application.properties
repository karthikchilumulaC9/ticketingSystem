# src/main/resources/application.properties
spring.application.name=Distributed Ticketing Management System

# DataSource Configuration
spring.datasource.url=jdbc:mysql://localhost:3306/distributedticketingmanagementsystemapplication?serverTimezone=UTC&useSSL=false&allowPublicKeyRetrieval=true&createDatabaseIfNotExist=true
spring.datasource.username=root
spring.datasource.password=${DB_PASSWORD:root}
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# HikariCP Connection Pool Settings (Enterprise-level)
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.idle-timeout=30000
spring.datasource.hikari.pool-name=TicketingHikariCP
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.connection-timeout=30000

# Hibernate & JPA Configuration
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.open-in-view=false

# ==================== Redis Configuration ====================
# Redis Connection
spring.data.redis.host=${REDIS_HOST:localhost}
spring.data.redis.port=${REDIS_PORT:6379}
spring.data.redis.password=${REDIS_PASSWORD:}
spring.data.redis.timeout=60000

# Redis Connection Pooling (Lettuce)
spring.data.redis.lettuce.pool.max-active=8
spring.data.redis.lettuce.pool.max-idle=8
spring.data.redis.lettuce.pool.min-idle=2
spring.data.redis.lettuce.pool.max-wait=-1ms

# Application Cache Settings
app.cache.ttl-minutes=30

# Enable SQL Logging for debugging
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# Redis and Cache Logging
logging.level.org.springframework.data.redis=INFO
logging.level.org.example.distributedticketingmanagementsystem.service.TicketCacheService=INFO
logging.level.org.example.distributedticketingmanagementsystem.service.TicketServiceImp=INFO

# Application Logging
logging.level.org.example.distributedticketingmanagementsystem.controller=INFO
logging.level.org.example.distributedticketingmanagementsystem.exception=INFO
logging.level.org.example.distributedticketingmanagementsystem.service=INFO

# File Upload Configuration
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB

# Server Configuration
server.port=8085

# ==================== Kafka Configuration ====================
# Kafka Broker
spring.kafka.bootstrap-servers=${KAFKA_BOOTSTRAP_SERVERS:localhost:9092}

# Producer Configuration
spring.kafka.producer.key-serializer=org.apache.kafka.common.serialization.StringSerializer
spring.kafka.producer.value-serializer=org.springframework.kafka.support.serializer.JsonSerializer
spring.kafka.producer.acks=all
spring.kafka.producer.retries=3
spring.kafka.producer.properties.enable.idempotence=true

# Consumer Configuration
spring.kafka.consumer.group-id=ticketing-group
spring.kafka.consumer.key-deserializer=org.apache.kafka.common.serialization.StringDeserializer
spring.kafka.consumer.value-deserializer=org.springframework.kafka.support.serializer.JsonDeserializer
spring.kafka.consumer.auto-offset-reset=earliest
spring.kafka.consumer.enable-auto-commit=false
spring.kafka.consumer.properties.spring.json.trusted.packages=org.example.distributedticketingmanagementsystem.kafka.event,org.example.distributedticketingmanagementsystem.dto

# Kafka Topics
app.kafka.topics.ticket-events=ticket-events
app.kafka.topics.bulk-upload=ticket-bulk-upload

# ==================== Kafka Bulk Processing Configuration ====================
# Bulk Requests Topic - Main topic for bulk ticket processing
app.kafka.topics.bulk-requests=ticket.bulk.requests
app.kafka.topics.bulk-requests.partitions=5
app.kafka.topics.bulk-requests.replicas=3
app.kafka.topics.bulk-requests.retention-days=7

# Bulk Notifications Topic - For completion notifications
app.kafka.topics.bulk-notifications=ticket.bulk.notifications

# Consumer Group for Bulk Processing
app.kafka.consumer.bulk-group-id=ticket-bulk-consumers
app.kafka.consumer.concurrency=3
app.kafka.consumer.batch-size=100
app.kafka.consumer.poll-timeout-ms=1000

# Kafka Retry Configuration (Exponential Backoff)
app.kafka.retry.max-attempts=3
app.kafka.retry.initial-interval-ms=1000
app.kafka.retry.multiplier=2.0
app.kafka.retry.max-interval-ms=10000

# Bulk Upload Configuration
app.kafka.bulk.chunk-size=100
app.kafka.bulk.max-file-size-mb=10
app.kafka.bulk.max-records=10000

# Producer Settings
app.kafka.producer.send-timeout-seconds=30
app.kafka.producer.async=true

# Bulk Processing Logging
logging.level.org.example.distributedticketingmanagementsystem.kafka=INFO
logging.level.org.example.distributedticketingmanagementsystem.kafka.consumer=DEBUG
logging.level.org.example.distributedticketingmanagementsystem.kafka.producer=DEBUG

# ==================== Error Handling Configuration ====================
# Disable stack trace in error responses
server.error.include-stacktrace=never
server.error.include-message=always
server.error.include-binding-errors=always
server.error.include-exception=false

# Disable default whitelabel error page (use custom error handling)
server.error.whitelabel.enabled=false

# Set error path for custom error controller
server.error.path=/error

# Disable RFC 7807 ProblemDetail format (use custom ErrorResponse)
spring.mvc.problemdetails.enabled=false


